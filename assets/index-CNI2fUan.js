(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function l(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(i){if(i.ep)return;i.ep=!0;const n=l(i);fetch(i.href,n)}})();const u=document.getElementById("simCanvas"),o=u.getContext("2d");if(!o)throw new Error("2D context not available.");const L=document.getElementById("gridWidth"),P=document.getElementById("gridHeight"),b=document.getElementById("interval"),S=document.getElementById("pixel"),C=document.getElementById("startPauseBtn"),k=document.getElementById("resetBtn"),m=document.getElementById("settingsModal"),T=document.getElementsByClassName("close")[0],A=document.getElementById("openModalBtn");let s=parseInt(S.value,10),a=30,d=30,f=[],g=new Set,h=!1,w=null;function O(){f=[];for(let e=0;e<d;e++){const t=new Array(a).fill(!1);f.push(t)}g.clear()}function x(){if(o){u.width=a*s,u.height=d*s,o.fillStyle="white",o.fillRect(0,0,u.width,u.height),o.strokeStyle="#ccc";for(let e=0;e<=a;e++){const t=e*s;o.beginPath(),o.moveTo(t,0),o.lineTo(t,u.height),o.stroke()}for(let e=0;e<=d;e++){const t=e*s;o.beginPath(),o.moveTo(0,t),o.lineTo(u.width,t),o.stroke()}}}function R(){h&&E(),x();for(let e=0;e<d;e++)for(let t=0;t<a;t++)f[e][t]&&B(e,t,!0)}function B(e,t,l){o&&(o.fillStyle=l?"green":"white",o.fillRect(t*s,e*s,s,s),o.strokeStyle="#ccc",o.strokeRect(t*s,e*s,s,s))}function M(){if(G()){E();return}const e=f.map(l=>l.slice()),t=new Set;g.forEach(l=>{const[c,i]=l.split(","),n=parseInt(c,10),r=parseInt(i,10);e[n][r]||(e[n][r]=!0,B(n,r,!0)),[[n-1,r],[n+1,r],[n,r-1],[n,r+1]].forEach(([p,y])=>{p>=0&&p<d&&y>=0&&y<a&&(e[p][y]||(e[p][y]=!0,B(p,y,!0),t.add(`${p},${y}`)))})}),g.clear(),g=t,f=e,h&&(w=window.setTimeout(M,b.valueAsNumber))}function $(e,t){const l=f[e][t],c=!l;f[e][t]=c,B(e,t,c);const i=`${e},${t}`,n=[[e-1,t],[e+1,t],[e,t-1],[e,t+1]];!l&&c?g.add(i):l&&!c&&(g.delete(i),n.forEach(([r,v])=>{r>=0&&r<d&&v>=0&&v<a&&f[r][v]&&g.add(`${r},${v}`)}))}function z(){s=parseInt(S.value,10),I()}function N(){h||(h=!0,C.textContent="Pause",M())}function E(){h&&(h=!1,C.textContent="Start",w&&(clearTimeout(w),w=null))}function G(){return[[0,0],[0,a-1],[d-1,0],[d-1,a-1],[Math.floor(d/2),Math.floor(a/2)]].every(([t,l])=>f[t][l])}function I(){E(),a=Math.max(5,parseInt(L.value,10)),d=Math.max(5,parseInt(P.value,10)),O(),x()}C.addEventListener("click",()=>{h?E():N()});k.addEventListener("click",()=>{I()});L.addEventListener("change",I);P.addEventListener("change",I);b.addEventListener("change",E);S.addEventListener("click",z);u.addEventListener("click",e=>{const t=u.getBoundingClientRect(),l=e.clientX-t.left,c=e.clientY-t.top,i=Math.floor(l/s),n=Math.floor(c/s);n>=0&&n<d&&i>=0&&i<a&&$(n,i)});window.addEventListener("resize",()=>{R()});A.onclick=function(){m&&(m.style.display="block")};T.onclick=function(){m&&(m.style.display="none")};window.onclick=function(e){m&&e.target==m&&(m.style.display="none")};I();
